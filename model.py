from transformers import AutoTokenizer, AutoModelForCausalLM
import torch
import torch.nn as nn
import torch.nn.functional as F
from params import *

# tokenizer = AutoTokenizer.from_pretrained("distilgpt2")
# model = AutoModelForCausalLM.from_pretrained("distilgpt2")

# MODEL_PATH = "GPTheadlines-0.pt"
# weights = torch.load(MODEL_SAVE_DIR + MODEL_PATH)
# model.load_state_dict(weights)
# model.eval()

from transformers import pipeline, T5Tokenizer

summarizer = pipeline("summarization")
text = """The leading source of global news and information for more than 75 years. Facebook: https://www.facebook.com/NBCNews  Snapchat: https://www.snapchat.com/add/nbcnews  Twitter speichert Deine Standortangaben. Du kannst die Standortangabe vor jedem Tweet ein- oder ausschalten und Du hast jederzeit die Möglichkeit, Standortangaben nachträglich zu löschen. Mehr erfahren Hier ist aktuellen Überblick, worüber sich andere zur Zeit unterhalten. Folge mehr Accounts, um sofort Updates zu Themen zu bekommen, die dir wichtig sind. Sieh sofort die neueck with a hard bite! @NBCNews @MeetThePress What makes them we believe anything that comes the former anything?! They were/are corrupt to the core!!! @NBCNews @MeetThePress oh yea this guy has never lied befoThe leading source of global news and information for more than 75 years. Facebook: https://www.facebook.com/NBCNews  Snapchat: https://www.snapchat.com/add/nbcnews  Twitter speichert Deine Standortangaben. Du kannst die Standortangabe vor jedem Tweet ein- oder ausschalten und Du hast jederzeit die Möglichkeit, Standortangaben nachträglich zu löschen. Mehr erfahren Hier ist aktuellen Überblick, worüber sich andere zur Zeit unterhalten. Folge mehr Accounts, um sofort Updates zu Themen zu bekommen, die dir wichtig sind. Sieh sofort die neueck with a hard bite! @NBCNews @MeetThePress What makes them we believe anything that comes the former anything?! They were/are corrupt to the core!!! @NBCNews @MeetThePress oh yea this guy has never lied befo.The leading source of global news and information for more than 75 years. Facebook: https://www.facebook.com/NBCNews  Snapchat: https://www.snapchat.com/add/nbcnews  Twitter speichert Deine Standortangaben. Du kannst die Standortangabe vor jedem Tweet ein- oder ausschalten und Du hast jederzeit die Möglichkeit, Standortangaben nachträglich zu löschen. Mehr erfahren Hier ist aktuellen Überblick, worüber sich andere zur Zeit unterhalten. Folge mehr Accounts, um sofort Updates zu Themen zu bekommen, die dir wichtig sind. Sieh sofort die neueck with a hard bite! @NBCNews @MeetThePress What makes them we believe anything that comes the former anything?! They were/are corrupt to the core!!! @NBCNews @MeetThePress oh yea this guy has never lied befo.The leading source of global news and information for more than 75 years. Facebook: https://www.facebook.com/NBCNews  Snapchat: https://www.snapchat.com/add/nbcnews  Twitter speichert Deine Standortangaben. Du kannst die Standortangabe vor jedem Tweet ein- oder ausschalten und Du hast jederzeit die Möglichkeit, Standortangaben nachträglich zu löschen. Mehr erfahren Hier ist aktuellen Überblick, worüber sich andere zur Zeit unterhalten. Folge mehr Accounts, um sofort Updates zu Themen zu bekommen, die dir wichtig sind. Sieh sofort die neueck with a hard bite! @NBCNews @MeetThePress What makes them we believe anything that comes the former anything?! They were/are corrupt to the core!!! @NBCNews @MeetThePress oh yea this guy has never lied befo.The leading source of global news and information for more than 75 years. Facebook: https://www.facebook.com/NBCNews  Snapchat: https://www.snapchat.com/add/nbcnews  Twitter speichert Deine Standortangaben. Du kannst die Standortangabe vor jedem Tweet ein- oder ausschalten und Du hast jederzeit die Möglichkeit, Standortangaben nachträglich zu löschen. Mehr erfahren Hier ist aktuellen Überblick, worüber sich andere zur Zeit unterhalten. Folge mehr Accounts, um sofort Updates zu Themen zu bekommen, die dir wichtig sind. Sieh sofort die neueck with a hard bite! @NBCNews @MeetThePress What makes them we believe anything that comes the former anything?! They were/are corrupt to the core!!! @NBCNews @MeetThePress oh yea this guy has never lied befo.The leading source of global news and information for more than 75 years. Facebook: https://www.facebook.com/NBCNews  Snapchat: https://www.snapchat.com/add/nbcnews  Twitter speichert Deine Standortangaben. Du kannst die Standortangabe vor jedem Tweet ein- oder ausschalten und Du hast jederzeit die Möglichkeit, Standortangaben nachträglich zu löschen. Mehr erfahren Hier ist aktuellen Überblick, worüber sich andere zur Zeit unterhalten. Folge mehr Accounts, um sofort Updates zu Themen zu bekommen, die dir wichtig sind. Sieh sofort die neueck with a hard bite! @NBCNews @MeetThePress What makes them we believe anything that comes the former anything?! They were/are corrupt to the core!!! @NBCNews @MeetThePress oh yea this guy has never lied befo.The leading source of global news and information for more than 75 years. Facebook: https://www.facebook.com/NBCNews  Snapchat: https://www.snapchat.com/add/nbcnews  Twitter speichert Deine Standortangaben. Du kannst die Standortangabe vor jedem Tweet ein- oder ausschalten und Du hast jederzeit die Möglichkeit, Standortangaben nachträglich zu löschen. Mehr erfahren Hier ist aktuellen Überblick, worüber sich andere zur Zeit unterhalten. Folge mehr Accounts, um sofort Updates zu Themen zu bekommen, die dir wichtig sind. Sieh sofort die neueck with a hard bite! @NBCNews @MeetThePress What makes them we believe anything that comes the former anything?! They were/are corrupt to the core!!! @NBCNews @MeetThePress oh yea this guy has never lied befo.The leading source of global news and information for more than 75 years. Facebook: https://www.facebook.com/NBCNews  Snapchat: https://www.snapchat.com/add/nbcnews  Twitter speichert Deine Standortangaben. Du kannst die Standortangabe vor jedem Tweet ein- oder ausschalten und Du hast jederzeit die Möglichkeit, Standortangaben nachträglich zu löschen. Mehr erfahren Hier ist aktuellen Überblick, worüber sich andere zur Zeit unterhalten. Folge mehr Accounts, um sofort Updates zu Themen zu bekommen, die dir wichtig sind. Sieh sofort die neueck with a hard bite! @NBCNews @MeetThePress What makes them we believe anything that comes the former anything?! They were/are corrupt to the core!!! @NBCNews @MeetThePress oh yea this guy has never lied befo.The leading source of global news and information for more than 75 years. Facebook: https://www.facebook.com/NBCNews  Snapchat: https://wwwn Überblick, worüber sich andere zur Zeit unterhalten. Folge mehr Accounts, um sofort Updates zu Themen zu bekommen, die dir wichtig sind. Sieh sofort die neueck with a hard bite! @NBCNews @MeetThePress What makes them we believe anything that comes the former anything?! They were/are corrupt to the core!!! @NBCNews @MeetThePress oh yea this guy has never lied befo.The leading source of global news and information for more than 75 years. Facebook: https://www.facebook.com/NBCNews  Snapchat: https://www.snapchat.com/add/nbcnews  Twitter speichert Deine Standortangaben. Du kannst die Standortangabe vor jedem Tweet ein- oder ausschalten und Du hast jederzeit die Möglichkeit, Standortangaben nachträglich zu löschen. Mehr erfahren Hier ist aktuellen Überblick, worüber sich andere zur Zeit unterhalten. Folge mehr Accounts, um sofort Updates zu Themen zu bekommen, die dir wichtig sind. Sieh sofort die neueck with a hard bite! @NBCNews @MeetThePress What makes them we believe anything that comes the former anything?! They were/are corrupt to the core!!! @NBCNews @MeetThePress oh yea this guy has never lied befo.The leading source of global news and information for more than 75 years. Facebook: https://www.facebook.com/NBCNews  Snapchat: https://www.snapchat.com/add/nbcnews  Twitter speichert Deine Standortangaben. Du kannst die Standortangabe vor jedem Tweet ein- oder ausschalten und Du hast jederzeit die Möglichkeit, Standortangaben nachträglich zu löschen. Mehr erfahren Hier ist aktuellen Überblick, worüber sich andere zur Zeit unterhalten. Folge mehr Accounts, um sofort Updates zu Themen zu bekommen, die dir wichtig sind. Sieh sofort die neueck with a hard bite! @NBCNews @MeetThePress What makes them we believe anything that comes the former anything?! They were/are corrupt to the core!!! @NBCNews @MeetThePress oh yea this guy has never lied befo.The leading source of global news and information for more than 75 years. Facebook: https://www.facebook.com/NBCNews  Snapchat: https://www.snapchat.com/add/nbcnews  Twitter speichert Deine Standortangaben. Du kannst die Standortangabe vor jedem Tweet ein- oder ausschalten und Du hast jederzeit die Möglichkeit, Standortangaben nachträglich zu löschen. Mehr erfahren Hier ist aktuellen Überblick, worüber sich andere zur Zeit unterhalten. Folge mehr Accounts, um sofort Updates zu Themen zu bekommen, die dir wichtig sind. Sieh sofort die neueck with a hard bite! @NBCNews @MeetThePress What makes them we believe anything that comes the former anything?! They were/are corrupt to the core!!! @NBCNews @MeetThePress oh yea this guy has never lied befo.The leading source of global news and information for more than 75 years. Facebook: https://www.facebook.com/NBCNews  Snapchat: https://www.snapchat.com/add/nbcnews  Twitter speichert Deine Standortangaben. Du kannst die Standortangabe vor jedem Tweet ein- oder ausschalten und Du hast jederzeit die Möglichkeit, Standortangaben nachträglich zu löschen. Mehr erfahren Hier ist aktuellen Überblick, worüber sich andere zur Zeit unterhalten. Folge mehr Accounts, um sofort Updates zu Themen zu bekommen, die dir wichtig sind. Sieh sofort die neueck with a hard bite! @NBCNews @MeetThePress What makes them we believe anything that comes the former anything?! They were/are corrupt to the core!!! @NBCNews @MeetThePress oh yea this guy has never lied befo.The leading source of global news and information for more than 75 years. Facebook: https://www.facebook.com/NBCNews  Snapchat: https://www.snapchat.com/add/nbcnews  Twitter speichert Deine Standortangaben. Du kannst die Standortangabe vor jedem Tweet ein- oder ausschalten und Du hast jederzeit die Möglichkeit, Standortangaben nachträglich zu löschen. Mehr erfahren Hier ist aktuellen Überblick, worüber sich ande"""
text = text[:2000]
summary_text = summarizer(text, max_length=20, min_length=-1, do_sample=False)[0]['summary_text']
print(summary_text)

# tokenizer = T5Tokenizer.from_pretrained('t5-small')
# encoding = tokenizer.encode_plus("hi my name is bob", max_length=10, padding='max_length', truncation=True, return_tensors='pt')

# print(tokenizer.pad_token_id)

# output = model.generate([[26, 27,28]])

# sequence = "Hello my name is Neville Chamberlain"

# inputs = tokenizer.encode(sequence, return_tensors='pt')
# outputs = model.generate(inputs, max_length=200, do_sample=True)

# text = tokenizer.decode(outputs[0], skip_special_tokens=True)
# print(text)


